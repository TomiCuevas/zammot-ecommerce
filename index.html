<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZAMMOT - Iniciar sesión</title>

    <link rel="icon" type="image/webp" href="./styles/img/zammot_bowtie.webp">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="./styles/css/login.css">
</head>

<body>

    <div class="login-wrapper">

        <div class="brand-card">
            <img src="./styles/img/zammot_bowtie.webp" alt="ZAMMOT" class="brand-logo">
            <div>
                <h2 class="brand-name">ZAMMOT</h2>
                <p class="brand-slogan">Tus productos de confianza</p>
            </div>
        </div>

        <div class="login-card">
            <h1>Iniciar sesión</h1>

            <form id="login-form" onsubmit="loginUser(event)">
                <div class="input-box">
                    <input type="email" id="email" placeholder="Email" required>
                </div>

                <div class="input-box">
                    <input type="password" id="password" placeholder="Contraseña" required>
                </div>
                <div class="remember-password">
                    <a href="#" onclick="openForgotModal()">¿Olvidaste tu contraseña?</a>
                </div>

                <button type="submit" class="btn btn-success w-100">Iniciar Sesión</button>

                <p class="register-link mt-3">
                    ¿Todavía no tienes cuenta?
                    <a href="./pages/Registro.html">Regístrate</a>
                </p>
            </form>

            <div class="text-center my-3">
                <span class="text-white-50">──────────  o  ──────────</span>
            </div>

            <div class="text-center mt-2">
                <button onclick="visitWithoutLogin()"
                        class="btn btn-outline-light w-100 d-flex align-items-center justify-content-center gap-2"
                        style="border-radius: 10px;">
                    <i class="bi bi-door-open"></i>
                    Ingresar sin iniciar sesión
                </button>
            </div>
        </div>
    </div>

    <script src="./js/auth.js"></script>

    
    <!--boton oculto para borar localstorage-->
    <button id="debug-clear-storage" 
        onclick="clearAllStorage()" 
        style="display:none; position:fixed; bottom:15px; right:15px; 
               padding:10px 14px; background:#dc3545; color:white; 
               border:none; border-radius:8px; z-index:9999;
               box-shadow:0 4px 10px rgba(0,0,0,0.4);">
        shhhhh
    </button>

    <script>
        // Mostrar/Ocultar botón con CTRL + SHIFT + L
        document.addEventListener("keydown", function(e) {
            if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === "l") {
                const btn = document.getElementById("debug-clear-storage");
                btn.style.display = btn.style.display === "none" ? "block" : "none";
            }
        });
        
        function clearAllStorage() {
            if (confirm("¿Seguro que deseas borrar TODO el localStorage?")) {

                localStorage.clear();

                alert("Se borró TODO el localStorage correctamente.");
            }
        }
    </script>

    <div id="forgotModal"
         style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
                background:rgba(0,0,0,0.65); backdrop-filter:blur(6px);
                justify-content:center; align-items:center; z-index:99999;">

        <div style="background:rgba(20,20,20,0.85); border:1px solid rgba(255,255,255,0.08);
                    padding:25px; border-radius:16px; width:90%; max-width:350px;
                    box-shadow:0 8px 25px rgba(0,0,0,0.5); text-align:center;
                    color:white; animation:fadeIn 0.25s ease-out;">

            <h4 style="margin-bottom:15px; letter-spacing:0.5px;">Recuperar contraseña</h4>

            <input id="forgotEmail"
                   type="email"
                   placeholder="Ingresa tu email"
                   style="width:100%; padding:12px; border-radius:10px;
                          border:1px solid rgba(255,255,255,0.2);
                          background:rgba(255,255,255,0.08); color:white;
                          outline:none; margin-bottom:10px;">

            <button onclick="sendRecoveryEmail()"
                    style="margin-top:10px; width:100%; padding:12px;
                           border:none; border-radius:10px; background:#28a745;
                           color:white; font-weight:600; letter-spacing:0.5px;">
                Enviar recuperación
            </button>

            <button onclick="closeForgotModal()"
                    style="margin-top:10px; width:100%; padding:10px;
                           border:none; border-radius:10px; background:#6c757d;
                           color:white; font-weight:500;">
                Cancelar
            </button>
        </div>
    </div>

    <style>
        @keyframes fadeIn {
            from { opacity:0; transform:scale(0.95); }
            to { opacity:1; transform:scale(1); }
        }
    </style>


    <!-- colocar minsuculas automaticas-->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const emailInput = document.getElementById("email");

            if (emailInput) {
                emailInput.addEventListener("input", () => {
                    emailInput.value = emailInput.value.toLowerCase(); // conversion automática
                });
            }
        });
    </script>

</body>
</html>
